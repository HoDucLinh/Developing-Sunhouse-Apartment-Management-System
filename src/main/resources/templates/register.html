<div th:replace="~{fragments/base :: layout}">
    <div th:fragment="content">
        <main class="p-3">
            <form th:action="@{/register}" method="post" th:object="${user}" >
                <div class="mb-3 mt-3">
                    <label for="username" class="form-label">User name</label>
                    <input type="text" class="form-control" id="username" th:field="*{username}" placeholder="Enter user name" required/>
                </div>
                <div class="mb-3">
                    <label for="pwd" class="form-label">Password</label>
                    <input type="password" class="form-control" id="pwd" th:field="*{password}" placeholder="Enter password" required/>
                </div>
                <div class="mb-3">
                    <label for="fullname" class="form-label">Full name</label>
                    <input type="text" class="form-control" id="fullname" th:field="*{fullName}" placeholder="Enter full name" required/>
                </div>
                <div class="mb-3">
                    <label for="phone" class="form-label">Phone</label>
                    <input type="text" class="form-control" id="phone" th:field="*{phone}" placeholder="Enter phone" required/>
                </div>
                <div class="mb-3">
                    <label for="email" class="form-label">Email</label>
                    <input type="text" class="form-control" id="email" th:field="*{email}" placeholder="Enter Email" required/>
                </div>

                <div class="mb-3">
                    <label class="form-label">Role:</label>
                    <div th:each="role : ${roles}" class="form-check form-check-inline">
                        <input class="form-check-input"
                               type="radio"
                               th:field="*{role}"
                               th:value="${role}"
                               th:id="'role-' + ${role}" />
                        <label class="form-check-label" th:for="'role-' + ${role}" th:text="${role}"></label>
                    </div>
                </div>


                <div id="floorRoomFields" style="display: none;">
                    <div>
                        <label>Floor:</label>
                        <select name="floorId" id="floorSelect">
                            <option th:each="floor : ${floors}" th:value="${floor.id}" th:text="'Tầng ' + ${floor.floorNumber}"></option>
                        </select>
                    </div>

                    <div>
                        <label>Room:</label>
                        <!-- KHÔNG dùng th:field="*{roomId}" -->
                        <select name="roomIdParam" id="roomSelect">
                            <option th:each="room : ${rooms}" th:value="${room.id}" th:text="${room.roomNumber}"></option>
                        </select>

                    </div>
                </div>

                <button type="submit" class="btn btn-primary">Add user</button>
            </form>

            <script>
                function toggleFields() {
                    const selectedRole = document.querySelector('input[name="role"]:checked');
                    const floorRoomFields = document.getElementById('floorRoomFields');
                    if (selectedRole && selectedRole.value === 'RESIDENT') {
                        floorRoomFields.style.display = 'block';
                    } else {
                        floorRoomFields.style.display = 'none';
                    }
                }

                document.querySelectorAll('input[name="role"]').forEach(radio => {
                    radio.addEventListener('change', toggleFields);
                });

                document.addEventListener('DOMContentLoaded', toggleFields);
            </script>

        </main>
    </div>
</div>